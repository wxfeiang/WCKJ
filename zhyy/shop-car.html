<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>购物车</title>
    <link rel="stylesheet" href="css/rest.css">
    <link rel="stylesheet" href="css/iconfont.css">
    <link rel="stylesheet" href="css/public.css">
    <link rel="stylesheet" href="css/shop-car.css">
</head>

<body>
    <!-- top -->
    <div class="top">
        <div class="layout top-box">
            欢迎来到鲸至医疗 您好 12124214124
            <span>请
                <a href="">登录</a>
                <a href="">注册</a>
            </span>
        </div>
    </div>
    <!-- top end -->
    <!-- header -->
    <div class="header">
        <div class="clearfix layout ">
            <div class="fl logo">
                <img src="images/logo.png" alt="logo" width="192px">
            </div>
            <div class="clearfix fr mag-top ">
                <div class="fl ">
                    <div class="curr-top curr-top1 active">
                        <b>1</b>
                        <span></span>
                    </div>
                    <p>
                        我的购物车
                    </p>

                </div>
                <div class="fl ">
                    <div class="curr-top curr-top2">
                        <b>2</b>
                        <span>
                        </span>
                    </div>
                    <p>
                        填写核对订单信息
                    </p>

                </div>
                <div class="fl ">
                    <div class="curr-top curr-top3">
                        <b>3</b>
                        <span></span>
                    </div>
                    <p>
                        成功提交订单
                    </p>

                </div>
            </div>

        </div>
    </div>
    <!-- header end -->
    <div class="msg-body">
        <div class="layout">
            <h3 class="top-h3">我的购物车</h3>
            <!-- table -->
            <div class="tab-box">
                <table border="0 " cellspacing="0" width="100%" class="table1" id="table">
                    <thead>
                        <tr>
                            <th>
                                <input type="checkbox" class="checkall check"> 全选
                            </th>
                            <th>商品</th>
                            <th>单价</th>
                            <th>数量</th>
                            <th>小计</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <input type="checkbox" class="check">
                            </td>
                            <td>
                                <div class="clearfix td-1">
                                    <div class="fl img-box">
                                        <img src="images/four-im3.jpg" alt="">
                                    </div>
                                    <p class="fl td-p1">
                                        血球分析仪BC-1800

                                    </p>
                                </div>

                            </td>
                            <td>
                                ￥130
                            </td>
                            <td>
                                <div class="nums">
                                    <span class="add">+</span>
                                    <input type="text" value="1">
                                    <span class="reduc">-</span>
                                </div>
                            </td>
                            <td>
                                ￥130
                            </td>
                            <td>
                                <dib class="btns">
                                    <span class="f37 ">删除</span>
                                </dib>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <input type="checkbox" class="check">
                            </td>
                            <td>
                                <div class="clearfix td-1">
                                    <div class="fl img-box">
                                        <img src="images/four-im3.jpg" alt="">
                                    </div>
                                    <p class="fl td-p1">
                                        血球分析仪BC-1800
                                    </p>
                                </div>

                            </td>
                            <td>
                                ￥130
                            </td>
                            <td>
                                <div class="nums">
                                    <span class="add">+</span>
                                    <input type="text" value="1">
                                    <span class="reduc">-</span>
                                </div>
                            </td>
                            <td>
                                ￥130
                            </td>
                            <td>
                                <dib class="btns">
                                    <span class="f37 ">删除</span>
                                </dib>
                            </td>
                        </tr>
                    </tbody>
                    <tfoot>
                        <tr>
                            <td colspan="2" class="foot1">
                                <input type="checkbox" class="checkall check"> 全选
                                <span>
                                    删除所有商品
                                </span>
                            </td>
                            <td colspan="4" class="foot2">
                                已选
                                <b id="selectdtotal">1</b> 件商品 总价（不包含运费）：
                                <b id="pretotal"> ￥130</b>
                                <strong class="bt">
                                    结算
                                </strong>
                            </td>
                        </tr>
                    </tfoot>

                </table>

            </div>
        </div>


    </div>



    <!-- footer -->
    <div class="footer">
        <div class="layout clearfix foot-top">
            <div class="ft-logo fl col-2 col-m-12">
                <img src="images/logo.png" alt="logo" width="192px">
            </div>
            <div class="links fr col-6 col-m-12">
                <div class="links-list">
                    <a href="">鲸至医疗</a>
                    <a href="">资质证书</a>
                    <a href="">隐私安全</a>
                    <a href="">联系我们</a>
                    <a href="">关于我们</a>
                </div>
                <div class="links-list">
                    <a href="">支付方式</a>
                    <a href="">在线支付</a>
                    <a href="">银行转账</a>
                    <a href="">其他支付方式</a>

                </div>
                <div class="links-list">
                    <a href="">配送方式</a>
                    <a href="">快速运输</a>

                </div>
                <div class="links-list">
                    <a href="">新手指南</a>
                    <a href="">用户注册</a>
                    <a href="">购物流程</a>
                </div>
            </div>

        </div>
        <div class="layout partner">
            <a href="">隐私声明</a>
            <a href="">法律声明</a>
            <a href="">联系我们</a>
            <a href="">关于我们</a>
            <a href="">产品地图</a>
            <a href="">器械数据库</a>
            <a href="">知识库</a>
            <a href="">网站导航</a>
            <a href="">互联网药品信息服务资格证</a>
            <br>
            <span>技术支持: 中企高呈</span>
        </div>
    </div>
    <!-- footer end -->

</body>
<script src="js/jquery-1.8.3.min.js"></script>
<script>
    // $(function () {

    //     $(".labbox label").each(function () {
    //         $(this).click(function () {
    //             $(this)
    //                 .addClass("active")
    //                 .find("i")
    //                 .html("&#xe635;");
    //             $(this)
    //                 .parent()
    //                 .siblings()
    //                 .find(" label").removeClass("active")
    //                 .find("i")
    //                 .html("&#xe67b;")
    //         })
    //     })
    // })
    // for(i= 0;i<div.length;i++){
    //     console.log(i)
    //     div[i].setAttribute("id","id"+i)
    // }
    // 购物车



    var table = document.getElementById("table")
    var tr = table.children[1].rows; // tbody 行
    var checkIput = document.getElementsByClassName("check")
    var checkall = document.getElementsByClassName("checkall")
    var selectdtotal = document.getElementById("selectdtotal")
    var pretotal = document.getElementById("pretotal")

    // 计算
    function trim(str) {
        return str.replace(/^(\s|\xA0)+|(\s|\xA0)+$/g, '');
    }

    function gettotal() {
        // 每一行累加
        var selected = 0;
        var prected = 0;

        for (var i = 0, len = tr.length; i < len; i++) {
            if (tr[i].getElementsByTagName("input")[0].checked) {
                selected += tr[i].getElementsByTagName("input")[1].value * 1;
                prected += trim(tr[i].cells[4].innerHTML).substring(1) * 1

            }
        }
        selectdtotal.innerHTML = selected;
        pretotal.innerHTML = "￥" + prected;

    }


    //  checkout
    for (var i = 0, len = checkIput.length; i < len; i++) {
        var title = 0;
        checkIput[i].onclick = function () {

            //全选
            if (this.className === "checkall check") {
                for (var j = 0; j < checkIput.length; j++) {
                    checkIput[j].checked = this.checked;

                }
            }
            if (this.checked == false) {
                for (var k = 0; k < checkall.length; k++) {
                    checkall[k].checked = false;

                }
            }

            gettotal();
        }
    }
    // 增加
    for (var i = 0; i < tr.length; i++) {
        tr[i].onclick = function (e) {
            e = e || window.event;
            var el = e.srcElement;
            var cls = el.className;
            var input = this.getElementsByTagName("input")[1];
            var val = input.value * 1

            switch (cls) {
                case ("add"):
                    input.value = val + 1
                    getsutal(this);
                    break;
                case ("reduc"):
                    input.value = val - 1
                    if(val<=1){
                        alert("0")
                    }
                    getsutal(this); 
                    break;
                case("del"):
                break;
                default:
                    break;
            }
            gettotal();

        }
        // 输入
        tr[i].getElementsByTagName("input")[1].onkeyup = function(){
            var tr = this.parentNode.parentNode.parentNode;
            getsutal(tr);
            gettotal();
            
        }


    }
    // 小计
    function getsutal (tr){
        var tds = tr.cells;
        var price = trim(tds[2].innerHTML).substring(1) * 1  // 价格
        var cont = tr.getElementsByTagName("input")[1].value * 1; // 数量
        var subtal  = parseFloat(price * cont);
        tds[4].innerHTML = "￥"+ subtal;

    }
</script>

</html>